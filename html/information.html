<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>我的通知悬浮框</title>
    <link href="../css/hoverPane.css" rel="stylesheet" type="text/css">
    <script src="../js/jquery-3.5.1.js"></script>
    <script src="../js/debounce.js"></script>
</head>

<body>
    <div class="hoverBox">
        <div class="title ">消息通知</div>
        <div class="mode_selection">
            <span class="mode active" id="hoverBox_interest">动态通知</span>
            <span class="mode" id="hoverBox_fans">私信通知</span>
            <span class="activeLine toLeft"></span>
        </div>
        <!-- 内容框 -->
        <div class="contentBox_information">
            <div class="itemList_box">
                <ul class="itemList">

                    <li class="item">
                        <img src="../../img/user_profile/use1 (1).jpg">
                        <svg class="info_point" class="icon" height="10" p-id="12380" t="1602330426902" version="1.1" viewBox="0 0 1024 1024" width="10" xmlns="http://www.w3.org/2000/svg">
                        <path d="M512 512m-512 0a512 512 0 1 0 1024 0 512 512 0 1 0-1024 0Z" fill="#E6A23C"
                              p-id="12381"></path>
                    </svg>
                        <span class="userName itemTitle">用户名</span>
                        <span class="item_info">为了提供更好的创作体验，知乎创作中心进行了多方面的升级。</span>
                        <span class="time">21:53</span>
                    </li>
                    <li class="item">
                        <img src="../../img/user_profile/use1 (1).jpg">
                        <svg class="info_point" class="icon" height="10" p-id="12380" t="1602330426902" version="1.1" viewBox="0 0 1024 1024" width="10" xmlns="http://www.w3.org/2000/svg">
                        <path d="M512 512m-512 0a512 512 0 1 0 1024 0 512 512 0 1 0-1024 0Z" fill="#E6A23C"
                              p-id="12381"></path>
                    </svg>
                        <span class="userName itemTitle">用户名</span>
                        <span class="item_info">为了提供更好的创作体验，知乎创作中心进行了多方面的升级。</span>
                        <span class="time">21:53</span>
                    </li>
                    <li class="item">
                        <img src="../../img/user_profile/use1 (1).jpg">
                        <svg class="info_point" class="icon" height="10" p-id="12380" t="1602330426902" version="1.1" viewBox="0 0 1024 1024" width="10" xmlns="http://www.w3.org/2000/svg">
                        <path d="M512 512m-512 0a512 512 0 1 0 1024 0 512 512 0 1 0-1024 0Z" fill="#E6A23C"
                              p-id="12381"></path>
                    </svg>
                        <span class="userName itemTitle">用户名</span>
                        <span class="item_info">为了提供更好的创作体验，知乎创作中心进行了多方面的升级。</span>
                        <span class="time">21:53</span>
                    </li>
                    <li class="item">
                        <img src="../../img/user_profile/use1 (1).jpg">
                        <svg class="info_point" class="icon" height="10" p-id="12380" t="1602330426902" version="1.1" viewBox="0 0 1024 1024" width="10" xmlns="http://www.w3.org/2000/svg">
                        <path d="M512 512m-512 0a512 512 0 1 0 1024 0 512 512 0 1 0-1024 0Z" fill="#E6A23C"
                              p-id="12381"></path>
                    </svg>
                        <span class="userName itemTitle">用户名</span>
                        <span class="item_info">为了提供更好的创作体验，知乎创作中心进行了多方面的升级。</span>
                        <span class="time">21:53</span>
                    </li>
                    <li class="item">
                        <img src="../../img/user_profile/use1 (1).jpg">
                        <svg class="info_point" class="icon" height="10" p-id="12380" t="1602330426902" version="1.1" viewBox="0 0 1024 1024" width="10" xmlns="http://www.w3.org/2000/svg">
                        <path d="M512 512m-512 0a512 512 0 1 0 1024 0 512 512 0 1 0-1024 0Z" fill="#E6A23C"
                              p-id="12381"></path>
                    </svg>
                        <span class="userName itemTitle">用户名</span>
                        <span class="item_info">为了提供更好的创作体验，知乎创作中心进行了多方面的升级。</span>
                        <span class="time">21:53</span>
                    </li>
                    <li class="item">
                        <img src="../../img/user_profile/use1 (1).jpg">
                        <svg class="info_point" class="icon" height="10" p-id="12380" t="1602330426902" version="1.1" viewBox="0 0 1024 1024" width="10" xmlns="http://www.w3.org/2000/svg">
                        <path d="M512 512m-512 0a512 512 0 1 0 1024 0 512 512 0 1 0-1024 0Z" fill="#E6A23C"
                              p-id="12381"></path>
                    </svg>
                        <span class="userName itemTitle">用户名</span>
                        <span class="item_info">为了提供更好的创作体验，知乎创作中心进行了多方面的升级。</span>
                        <span class="time">21:53</span>
                    </li>

                </ul>
            </div>
        </div>
        <div class="foot">
            <svg class="clearAllPoint" height="16" title="一键已读" viewBox="0 0 1024 1024" width="16">
            <path d="M965.12 286.293333H657.493333V108.8C657.493333 48.64 605.013333 0 540.586667 0H482.56C418.56 0.426667 366.506667 49.066667 366.506667 108.8V285.866667H58.453333C26.026667 285.866667 0 310.613333 0 341.333333v176.213334c0 30.293333 26.453333 55.466667 58.453333 55.466666v253.866667c-0.426667 46.933333-6.826667 93.44-18.346666 135.253333l-0.853334 6.4c0 30.72 26.453333 55.466667 58.453334 55.466667H926.293333c30.293333 0 57.6-22.613333 59.733334-49.493333l-0.853334-7.253334c-12.8-46.933333-19.2-96-19.626666-145.066666v-248.32l19.2-3.84c22.613333-7.68 38.4-28.16 38.4-52.053334V341.76c0.426667-30.72-26.026667-55.466667-58.026667-55.466667z m-210.773333 650.24V733.866667c0-18.346667-15.786667-33.28-34.56-33.28h-9.813334c-19.2 0-34.56 14.933333-34.56 33.28v202.666666h-113.92V733.866667c0-18.346667-15.786667-33.28-34.56-33.28h-9.813333c-19.2 0-34.56 14.933333-34.56 33.28v202.666666H359.253333V733.866667c0-18.346667-15.786667-33.28-34.56-33.28h-9.813333c-19.2 0-34.56 14.933333-34.56 33.28v202.666666l-146.346667 2.56c8.96-34.986667 13.226667-70.826667 13.226667-107.093333v-259.413333h729.173333V836.266667c0 33.706667 3.84 67.84 11.52 99.84h-133.546666zM931.84 486.4H91.733333V372.906667H456.96v-251.733334c0-27.733333 33.28-30.72 47.786667-30.72h16.213333c14.506667 0 47.786667 2.986667 47.786667 30.72v253.866667h363.093333V486.4z"
                  fill="#bfbfbf" p-id="12613"></path>
        </svg>
        </div>
    </div>
    <script id="item_template" type="text/html">
        <li class="item">
            <a class="img_link" href="#" title="进入主页">
                <img src="{{}}">
            </a>
            <span class="userName">{{userName}}</span>
            <span class="status">{{status}}</span>
            <div class="sex">
                {{sex}}
            </div>

            <span class="school_info">{{school_info}}</span>
            <!-- 是否关注 -->
            <div class="subscribe" nextAction="{{action}}" title="关注">
                <!--红 #d6204b -->
               <img src='../icon/information/subscribe.svg'>
            </div>
            <!-- 私信 -->
            <div class="sendText" title="私信">
                <!-- #17abe3 -->
              <img src='../icon/information/sendTextBtn.svg'>
            </div>
        </li>
    </script>
    <script>
        // let a = {
        //         "last": "无效参数",
        //         "next": "是否有下一页",
        //         "totalPage": "总页数",
        //         "nowPosition": "现在的页数",
        //         "dataList": [{
        //             "userName": "用户名",
        //             "userType": "用户类型", // student / teacher 要自己判断
        //             "sex": "性别",
        //             "collage": "院校",
        //             "major": "专业",
        //             "mutual": "是否相互关注"
        //         }],
        //         "page_SIZE": "页面大小"
        //     }
            //刚打开悬浮板，就发送
            //切换为我的回答
            //去右边
        $('#hoverBox_fans').click(function() {
                $(this).addClass("active");
                $("#hoverBox_interest").removeClass("active");
                $('.hoverBox .activeLine').addClass("toRight");
                $('.hoverBox .activeLine').removeClass("toLeft");
                $('.hoverBox .title').html($(this).html())
                    //发送请求
            })
            //去左边
        $('#hoverBox_interest').click(function() {
            $(this).addClass("active");
            $("#hoverBox_fans").removeClass("active");
            $('.hoverBox .activeLine').addClass("toLeft");
            $('.hoverBox .activeLine').removeClass("toRight");
            $('.hoverBox .title').html($(this).html())
                //发送请求
        })

        //还没关注之前，点击后发送关注请求，并且成功后把状态变成关注，点亮
        //如果当前是已关注，title为取消关注

        // 点击关注按钮，并且是当前状态为turnON ，就发送请求发送关注，如果为turnOff就发送取消关注请求
        $('.hoverBox .contentBox_subscribe .item .subscribe').click(function() {
            if ($(this).attr("nextAction") == 'turnOn') {
                //发送关注请求
                $(this).find('svg path').css("fill", "#d6204b");
                $(this).attr({
                    "nextAction": "turnOff",
                    "title": "取消关注"
                });
            } else {
                $(this).find('svg path').css("fill", "#bfbfbf");
                $(this).attr({
                    "nextAction": "turnOn",
                    "title": "关注"
                });
            }
        })

        let page = 1; //可以写在list的属性中
        let num = 6;
        //用到节流防抖，先不做
        $('.itemList_box').scroll(debounce(getData, 300));

        //获取数据函数
        function getData() {
            //滚动条到顶部的高度
            let scrollTop = Math.ceil($(this).scrollTop());
            //窗口高度
            let curHeight = $(this).height();
            //整个文档高度
            let totalHeight = $('.itemList').height();
            //滚动条到底
            console.log("拖拽滚动条");
            if (scrollTop + curHeight > totalHeight) {
                page++;
                console.log(page)
                console.log("到达了底部")
                    // getData();//获取数据的方法
                    //console.log(123);
            }
        }
    </script>


</body>

</html>